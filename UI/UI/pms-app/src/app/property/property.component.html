<div class="property-container">
  <h2>{{ isEdit() ? 'Hotel Property Information' : 'Setup Hotel Property' }}</h2>
  
  @if (!submitted()) {
    <form #propertyForm="ngForm" (ngSubmit)="saveProperty()" class="property-form">
      
      @if (errorMessage) {
        <div class="error-banner">{{ errorMessage }}</div>
      }

      <!-- Basic Information -->
      <div class="section">
        <h3>Basic Information</h3>
        
        <div class="form-group">
          <label for="name">Property Name *</label>
          <input 
            #propertyNameInput
            type="text" 
            id="name" 
            name="name"
            [(ngModel)]="property().name"
            required
            #name="ngModel"
            placeholder="Enter hotel name"
          />
          @if (name.invalid && name.touched) {
            <small class="error">Property name is required</small>
          }
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="type">Property Type *</label>
            <select 
              id="type" 
              name="type"
              [(ngModel)]="property().type"
              required
              #type="ngModel"
            >
              @for (pt of propertyTypes; track pt) {
                <option [value]="pt.toLowerCase()">{{ pt }}</option>
              }
            </select>
          </div>

          <div class="form-group">
            <label for="starRating">Star Rating *</label>
            <select 
              id="starRating" 
              name="starRating"
              [(ngModel)]="property().starRating"
              required
              #starRating="ngModel"
            >
              @for (rating of starRatings; track rating) {
                <option [value]="rating">{{ rating }} Star{{ rating > 1 ? 's' : '' }}</option>
              }
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea 
            id="description" 
            name="description"
            [(ngModel)]="property().description"
            rows="4"
            placeholder="Brief description of your property..."
          ></textarea>
        </div>
      </div>

      <!-- Contact Information -->
      <div class="section">
        <h3>Contact Information</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label for="phone">Phone *</label>
            <input 
              type="tel" 
              id="phone" 
              name="phone"
              [(ngModel)]="property().phone"
              required
              #phone="ngModel"
              placeholder="+1 (555) 123-4567"
            />
            @if (phone.invalid && phone.touched) {
              <small class="error">Phone is required</small>
            }
          </div>

          <div class="form-group">
            <label for="email">Email *</label>
            <input 
              type="email" 
              id="email" 
              name="email"
              [(ngModel)]="property().email"
              required
              email
              #email="ngModel"
              placeholder="hotel@example.com"
            />
            @if (email.invalid && email.touched) {
              <small class="error">Valid email is required</small>
            }
          </div>
        </div>

        <div class="form-group">
          <label for="website">Website</label>
          <input 
            type="url" 
            id="website" 
            name="website"
            [(ngModel)]="property().website"
            placeholder="https://www.yourhotel.com"
          />
        </div>
      </div>

      <!-- Address Information -->
      <div class="section">
        <h3>Address</h3>
        
        <div class="form-group">
          <label for="address">Street Address *</label>
          <input 
            type="text" 
            id="address" 
            name="address"
            [(ngModel)]="property().address"
            required
            #address="ngModel"
            placeholder="123 Main Street"
          />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="city">City *</label>
            <input 
              type="text" 
              id="city" 
              name="city"
              [(ngModel)]="property().city"
              required
              #city="ngModel"
              placeholder="New York"
            />
          </div>

          <div class="form-group">
            <label for="state">State/Province *</label>
            <input 
              type="text" 
              id="state" 
              name="state"
              [(ngModel)]="property().state"
              required
              #state="ngModel"
              placeholder="NY"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="zipCode">ZIP/Postal Code *</label>
            <input 
              type="text" 
              id="zipCode" 
              name="zipCode"
              [(ngModel)]="property().zipCode"
              required
              #zipCode="ngModel"
              placeholder="10001"
            />
          </div>

          <div class="form-group">
            <label for="country">Country *</label>
            <input 
              type="text" 
              id="country" 
              name="country"
              [(ngModel)]="property().country"
              required
              #country="ngModel"
              placeholder="United States"
            />
          </div>
        </div>
      </div>

      <!-- Property Details -->
      <div class="section">
        <h3>Property Details</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label for="numberOfRooms">Number of Rooms *</label>
            <input 
              type="number" 
              id="numberOfRooms" 
              name="numberOfRooms"
              [(ngModel)]="property().numberOfRooms"
              required
              min="1"
              #numberOfRooms="ngModel"
              placeholder="50"
            />
            @if (numberOfRooms.invalid && numberOfRooms.touched) {
              <small class="error">Number of rooms is required</small>
            }
          </div>

          <div class="form-group">
            <label for="currency">Currency *</label>
            <select 
              id="currency" 
              name="currency"
              [(ngModel)]="property().currency"
              required
            >
              @for (curr of currencies; track curr) {
                <option [value]="curr">{{ curr }}</option>
              }
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="checkInTime">Check-In Time *</label>
            <input 
              type="time" 
              id="checkInTime" 
              name="checkInTime"
              [(ngModel)]="property().checkInTime"
              required
            />
          </div>

          <div class="form-group">
            <label for="checkOutTime">Check-Out Time *</label>
            <input 
              type="time" 
              id="checkOutTime" 
              name="checkOutTime"
              [(ngModel)]="property().checkOutTime"
              required
            />
          </div>
        </div>

        <div class="form-group">
          <label for="taxRate">Tax Rate (%)</label>
          <input 
            type="number" 
            id="taxRate" 
            name="taxRate"
            [(ngModel)]="property().taxRate"
            min="0"
            max="100"
            step="0.01"
            placeholder="10.00"
          />
        </div>
      </div>

      <!-- Amenities -->
      <div class="section">
        <h3>Amenities</h3>
        <div class="amenities-grid">
          @for (amenity of availableAmenities; track amenity) {
            <label class="amenity-checkbox">
              <input 
                type="checkbox"
                [checked]="isAmenitySelected(amenity)"
                (change)="toggleAmenity(amenity)"
              />
              <span>{{ amenity }}</span>
            </label>
          }
        </div>
      </div>

      <!-- Policies -->
      <div class="section">
        <h3>Policies</h3>
        <div class="form-group">
          <label for="policies">Hotel Policies</label>
          <textarea 
            id="policies" 
            name="policies"
            [(ngModel)]="property().policies"
            rows="6"
            placeholder="Enter hotel policies (cancellation, pet policy, smoking, etc.)..."
          ></textarea>
        </div>
      </div>

      <!-- Appearance Settings -->
      <div class="section">
        <h3>üé® Appearance Settings</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label for="font">Font Family</label>
            <select 
              id="font" 
              name="font"
              [(ngModel)]="property().font"
            >
              @for (font of fonts; track font) {
                <option [value]="font.toLowerCase().replace(' ', '-')">{{ font }}</option>
              }
            </select>
            <small class="hint">Select the font style for your application</small>
          </div>

          <div class="form-group">
            <label for="theme">Color Theme</label>
            <select 
              id="theme" 
              name="theme"
              [(ngModel)]="property().theme"
            >
              @for (theme of themes; track theme) {
                <option [value]="theme.toLowerCase()">{{ theme }}</option>
              }
            </select>
            <small class="hint">Choose the color scheme for your application</small>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" [disabled]="propertyForm.invalid" class="btn-primary">
          {{ isEdit() ? 'Update Property' : 'Save Property' }}
        </button>
        @if (isEdit()) {
          <button type="button" (click)="resetForm()" class="btn-danger">
            Reset Property
          </button>
        }
      </div>
    </form>
  } @else {
    <div class="success-message">
      <h3>‚úì Property Information {{ isEdit() ? 'Updated' : 'Saved' }} Successfully!</h3>
      <div class="property-summary">
        <div class="summary-header">
          <h4>{{ property().name }}</h4>
          <span class="badge">{{ property().type }} - {{ property().starRating }} ‚≠ê</span>
        </div>
        
        <div class="summary-section">
          <h5>Contact</h5>
          <p><strong>Phone:</strong> {{ property().phone }}</p>
          <p><strong>Email:</strong> {{ property().email }}</p>
          @if (property().website) {
            <p><strong>Website:</strong> {{ property().website }}</p>
          }
        </div>

        <div class="summary-section">
          <h5>Address</h5>
          <p>{{ property().address }}</p>
          <p>{{ property().city }}, {{ property().state }} {{ property().zipCode }}</p>
          <p>{{ property().country }}</p>
        </div>

        <div class="summary-section">
          <h5>Details</h5>
          <p><strong>Rooms:</strong> {{ property().numberOfRooms }}</p>
          <p><strong>Check-In:</strong> {{ property().checkInTime }} | <strong>Check-Out:</strong> {{ property().checkOutTime }}</p>
          <p><strong>Currency:</strong> {{ property().currency }} | <strong>Tax Rate:</strong> {{ property().taxRate }}%</p>
        </div>

        @if (property().amenities.length > 0) {
          <div class="summary-section">
            <h5>Amenities</h5>
            <div class="amenities-list">
              @for (amenity of property().amenities; track amenity) {
                <span class="amenity-tag">{{ amenity }}</span>
              }
            </div>
          </div>
        }

        @if (property().description) {
          <div class="summary-section">
            <h5>Description</h5>
            <p>{{ property().description }}</p>
          </div>
        }
      </div>

      <div class="success-actions">
        <button (click)="editProperty()" class="btn-primary">Edit Property</button>
        <button (click)="viewDashboard()" class="btn-secondary">Go to Dashboard</button>
      </div>
    </div>
  }
</div>

<!-- Error Popup -->
<app-error-popup
  [isOpen]="isErrorPopupOpen"
  [error]="errorMessagePopup()"
  (closePopup)="closeErrorPopup()"
></app-error-popup>

<!-- Confirm Popup -->
<app-confirm-popup
  [isOpen]="isConfirmPopupOpen"
  [message]="confirmMessage()"
  (confirmed)="onConfirmed()"
  (cancelled)="onCancelled()"
></app-confirm-popup>
